<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.433">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Image Classification - Happy or Sad</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="Image_Classification_files/libs/clipboard/clipboard.min.js"></script>
<script src="Image_Classification_files/libs/quarto-html/quarto.js"></script>
<script src="Image_Classification_files/libs/quarto-html/popper.min.js"></script>
<script src="Image_Classification_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="Image_Classification_files/libs/quarto-html/anchor.min.js"></script>
<link href="Image_Classification_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="Image_Classification_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="Image_Classification_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="Image_Classification_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="Image_Classification_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script src="Image_Classification_files/libs/quarto-diagram/mermaid.min.js"></script>
<script src="Image_Classification_files/libs/quarto-diagram/mermaid-init.js"></script>
<link href="Image_Classification_files/libs/quarto-diagram/mermaid.css" rel="stylesheet">


</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Image Classification - Happy or Sad</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<p>This notebook demonstrates the process of building and training a Convolutional Neural Network (CNN) model to classify images as “happy” or “sad.” We will use TensorFlow and Keras for model creation and training.</p>
<div class="cell">
<div class="cell-output-display">
<div>
<div>
<pre class="mermaid mermaid-js">graph LR
  A[Input Layer] --&gt; B[Convolutional Layer 1]
  B --&gt; C[MaxPooling Layer 1]
  C --&gt; D[Convolutional Layer 2]
  D --&gt; E[MaxPooling Layer 2]
  E --&gt; F[Convolutional Layer 3]
  F --&gt; G[MaxPooling Layer 3]
  G --&gt; H[Flatten Layer]
  H --&gt; I[Dense Layer 1]
  I --&gt; J[Output Layer]

  style A fill:#f9f,stroke:#333,stroke-width:2px
  style B fill:#f9f,stroke:#333,stroke-width:2px
  style C fill:#f9f,stroke:#333,stroke-width:2px
  style D fill:#f9f,stroke:#333,stroke-width:2px
  style E fill:#f9f,stroke:#333,stroke-width:2px
  style F fill:#f9f,stroke:#333,stroke-width:2px
  style G fill:#f9f,stroke:#333,stroke-width:2px
  style H fill:#f9f,stroke:#333,stroke-width:2px
  style I fill:#f9f,stroke:#333,stroke-width:2px
  style J fill:#f9f,stroke:#333,stroke-width:2px

</pre>
</div>
</div>
</div>
</div>
<section id="data-preprocessing" class="level2">
<h2 class="anchored" data-anchor-id="data-preprocessing">Data Preprocessing</h2>
<p>In this section, we load and preprocess the dataset of images representing happy and sad emotions. We remove any images with unsupported file extensions and scale the pixel values to be between 0 and 1 for efficient training.</p>
<section id="preprocessing-code" class="level3">
<h3 class="anchored" data-anchor-id="preprocessing-code">Preprocessing Code</h3>
<div class="cell" data-execution_count="3">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Preprocessing Code</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="co">#%pip install tensorflow opencv-python matplotlib </span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> tensorflow <span class="im">as</span> tf</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> os</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="co"># ...</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="4">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>os.path.join(<span class="st">"data"</span>,<span class="st">"happy"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="4">
<pre><code>'data/happy'</code></pre>
</div>
</div>
</section>
<section id="check-if-a-gpu-is-available" class="level3">
<h3 class="anchored" data-anchor-id="check-if-a-gpu-is-available">Check if a GPU is available</h3>
<div class="cell" data-execution_count="2">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>gpus <span class="op">=</span> tf.config.experimental.list_physical_devices(<span class="st">'GPU'</span>)</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="bu">len</span>(gpus)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="2">
<pre><code>0</code></pre>
</div>
</div>
</section>
<section id="avoid-oom-errors-by-setting-gpu-memory-consumption-growth" class="level3">
<h3 class="anchored" data-anchor-id="avoid-oom-errors-by-setting-gpu-memory-consumption-growth">Avoid OOM Errors By Setting GPU Memory Consumption Growth</h3>
<div class="cell" data-execution_count="5">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Avoid OOM Errors By Setting GPU Memory Consumption Growth</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>gpus <span class="op">=</span> tf.config.experimental.list_physical_devices(<span class="st">'GPU'</span>)</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> gpu <span class="kw">in</span> gpus:</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>    tf.config.experimental.set_memory_growth(gpu, <span class="va">True</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="remove-dodgy-images" class="level3">
<h3 class="anchored" data-anchor-id="remove-dodgy-images">Remove dodgy images</h3>
<div class="cell" data-execution_count="6">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> cv2</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> imghdr</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>/var/folders/v8/l1n5gfyn3zj_f5m_0z4bv2m80000gn/T/ipykernel_4077/2011824555.py:2: DeprecationWarning: 'imghdr' is deprecated and slated for removal in Python 3.13
  import imghdr</code></pre>
</div>
</div>
<div class="cell" data-execution_count="7">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>data_dir <span class="op">=</span> <span class="st">"data"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="8">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>os.listdir(os.path.join(data_dir,<span class="st">"happy"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="8">
<pre><code>['images26.jpg',
 'images241.jpg',
 'images32.jpg',
 '89ca5d41335b4f9207b9cf03538a7dbd63497e474912837562cb9f58809ac32f._RI_TTW_.png',
 '05-12-21-happy-people.jpg',
 '110754-utyeqqosky-1547658396.jpeg',
 'image22.jpeg',
 'Happy.jpg',
 'images137.jpg',
 'Overtly-Cheerful-Primer-Editorials-min.png',
 'how-happy-are-healthy-people.jpg',
 '170404-happy-workers-feature.jpg',
 'images27.jpg',
 'friends-happy-190821.jpg',
 'images242.jpg',
 'goup-happy-people-group-jumping-isolated-white-background-35582232.jpg',
 'images134.jpg',
 'images120.jpg',
 'GettyImages-454356720.jpg',
 'WorldHappinessReport_620.jpg',
 '_86a43964-aa8e-11e8-82d1-388e3d6e11aa.jpg',
 'images243.jpg',
 'images30.jpg',
 'png-transparent-graphy-happy-people-love-child-photography-thumbnail.png',
 'young-and-happy-people-vector-15114154.jpg',
 'images247.jpg',
 'file-20230208-27-3jttof.jpg',
 'images125.jpg',
 'friends_190412.jpg',
 'images21.jpg',
 'images246.jpg',
 'happy-people-jump-with-raised-arms-characters-win_107791-14884.jpg',
 'images250.jpg',
 'images23.jpg',
 'happy-peaceful.jpg',
 'images132.jpg',
 'MV5BMTM3ODM0NTQ1MF5BMl5BanBnXkFtZTcwMzAxMTM5OA._V1_FMjpg_UX1000_.jpg',
 'gdfVVm_MyCRtqpvdkt8vtSB1n_oz_CpwCq6vNMpj0S8.jpg',
 'images245.jpg',
 'images236.jpg',
 'images79.jpg',
 'images183.jpg',
 'images197.jpg',
 'happiness.jpg',
 'images6.jpg',
 'maxresdefault.jpg',
 'shiny-happy-people.jpg',
 'images7.jpg',
 'images196.jpg',
 'images182.jpg',
 '20150413185238-secrets-happy-entrepreneurs-woman-gratitude-rainbow-.jpeg',
 'images78.jpg',
 'images50.jpg',
 'happy-person.jpeg',
 'images87.jpg',
 'images91.jpg',
 'images85.jpg',
 'images235.jpg',
 'image24.jpeg',
 'group-portrait-happy-people-disabilities-49330313.jpg',
 'images156.jpg',
 'GettyImages-871518740.jpg',
 'images195.jpg',
 'nm-how-happiness-affects-health-tnail.jpg',
 'images208.jpg',
 'images47.jpg',
 'images53.jpg',
 'images220.jpg',
 'images84.jpg',
 'group-young-happy-people-with-their-hands-up_369728-62.jpg',
 'images218.jpg',
 'images57.jpg',
 'images43.jpg',
 '1HEoLBLidT2u4mhJ0oiDgig.png',
 'images191.jpg',
 'images146.jpg',
 'where-to-watch-shiny-happy-people.jpg',
 'happy-woman-in-nature-at-sunset.jpg',
 'image25.jpeg',
 '9b65a25adca61c48bcb01370116723e3--happy-people-brings.jpg',
 '_happy_jumping_on_beach-40815.jpg',
 'i00YzYyLTkxY2ItY2I3OWE3NDBmNDVmXkEyXkFqcGdeQXVyMjkwOTAyMDU._V1_FMjpg_UX1000_.jpg',
 'VJdvLa-download-happy-blackman-png.png',
 'Duggar-Family-Secrets-Are-Exposed-in-New-Docuseries-Featuring-Jill-and-Amy-featured.png',
 '613k1XcpYCL.jpg',
 'images42.jpg',
 'images81.jpg',
 'images95.jpg',
 '56f455011e0000b300705475.jpeg',
 'images83.jpg',
 'hand-drawn-happy-friends-jumping_23-2149095224.jpg',
 'images179.jpg',
 'images150.jpg',
 'A_Sep20_14_1189155141.jpg',
 'ipsos-global-advisor-happiness-2022-opti.jpg',
 'images193.jpg',
 'images55.jpg',
 'images232.jpg',
 'happy-indians_5f66fd46d9f5b.jpg',
 'images70.jpg',
 'Happy-people-800x533.jpg',
 'Screen-Shot-2012-10-23-at-12.57.22-PM.png',
 'images161.jpg',
 'images149.jpg',
 'images148.jpg',
 'images160.jpg',
 'Screaming-Happy-Woman-THe-Trent.jpg',
 'images71.jpg',
 '343515-worldhappinessreport1440.jpg',
 'happiness_thumbnail.jpg',
 'images200.jpg',
 'images214.jpg',
 'images189.jpg',
 'images176.jpg',
 'happy-people.jpg',
 'image30.jpeg',
 'images66.jpg',
 'Successful-year.jpg',
 'images211.jpg',
 '7VR73K6EP5ETVEOUFANWBUYJEQ.jpg',
 'physed-happiness-superJumbo.jpg',
 'images9.jpg',
 '988689_Wallpaper2.jpg',
 'happy-people2.jpg',
 '35438_hd.jpg',
 'images199.jpg',
 'Happy-People-PNG.png',
 'happy-people-vector-839522.jpg',
 'images63.jpg',
 'images210.jpg',
 'images77.jpg',
 'images204.jpg',
 'images238.jpg',
 'Dollarphotoclub_76084977-1.jpg',
 'images49.jpg',
 'images206.jpg',
 'jumping-and-dancing-happy-people-positive-emotions-set-illustration-free-vector.jpg',
 'habits-of-happy-people.jpg',
 '1_617fd1e2590c2.jpg',
 'dv2051009.jpg',
 'happy-woman.jpg',
 '377dac1b50ef865c920abb84d9d3857d173750b14306061e9aa5b4a1ec0dcdfa-rimg-w1196-h796-gmir.jpg',
 'smile.woman_.jpg',
 'images159.jpg',
 'images74.jpg',
 'images13.jpg',
 'Happy-Guy.jpg',
 'getty_152414899_97046097045006_68075.jpg',
 'images102.jpg',
 'images117.jpg',
 '106827976-1611251261868-twenty20_33fd1f3f-9221-4c64-bcb1-bfeec3022d9b.jpg',
 'images249.jpg',
 'images12.jpg',
 'image16.jpeg',
 'images10.jpg',
 'what-makes-people-happy1.jpg',
 'getty_505175324_2000131020009280246_158016.jpg',
 'group-of-happy-people-2.jpg',
 'happy-people_1463241208.jpg',
 'images128.jpg',
 'images114.jpg',
 'getty_478389113_970647970450091_99776.jpg',
 'images11.jpg',
 'images29.jpg',
 'happy-people-in-the-poppy-field-1280x800-wide-wallpapers-net.jpg',
 'images15.jpg',
 'riskshappypeopletakeh_1384254283.jpg',
 '835405.jpg',
 'images110.jpg',
 'hdptcar-fi-2.jpg',
 'images105.jpg',
 'images139.jpg',
 'happy-woman-headphones-pink-african-american-1296x728-header.jpg',
 'web3-happy-people-outside-smile-sun-nature-eduardo-dutra-620857-unsplash.jpg',
 'hand-drawn-happy-people-jumping_23-2149092878.jpg',
 'images14.jpg',
 'goup-happy-people-35582464.jpg',
 'compassion-900x387.jpg',
 'images107.jpg',
 'happypeople-1024x679.jpg',
 'images106.jpg',
 'images17.jpg',
 'png-clipart-happiness-graphy-smile-happy-people-love-photography.png']</code></pre>
</div>
</div>
<div class="cell" data-execution_count="9">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>image_exts <span class="op">=</span> [<span class="st">"jpg"</span>, <span class="st">"jpeg"</span>, <span class="st">"png"</span>, <span class="st">"bmp"</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="10">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>image_exts[<span class="dv">0</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="10">
<pre><code>'jpg'</code></pre>
</div>
</div>
<div class="cell" data-execution_count="11">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> image_class <span class="kw">in</span> os.listdir(data_dir):</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> image <span class="kw">in</span> os.listdir(os.path.join(data_dir, image_class)):</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(image)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>images26.jpg
images241.jpg
images32.jpg
89ca5d41335b4f9207b9cf03538a7dbd63497e474912837562cb9f58809ac32f._RI_TTW_.png
05-12-21-happy-people.jpg
110754-utyeqqosky-1547658396.jpeg
image22.jpeg
Happy.jpg
images137.jpg
Overtly-Cheerful-Primer-Editorials-min.png
how-happy-are-healthy-people.jpg
170404-happy-workers-feature.jpg
images27.jpg
friends-happy-190821.jpg
images242.jpg
goup-happy-people-group-jumping-isolated-white-background-35582232.jpg
images134.jpg
images120.jpg
GettyImages-454356720.jpg
WorldHappinessReport_620.jpg
_86a43964-aa8e-11e8-82d1-388e3d6e11aa.jpg
images243.jpg
images30.jpg
png-transparent-graphy-happy-people-love-child-photography-thumbnail.png
young-and-happy-people-vector-15114154.jpg
images247.jpg
file-20230208-27-3jttof.jpg
images125.jpg
friends_190412.jpg
images21.jpg
images246.jpg
happy-people-jump-with-raised-arms-characters-win_107791-14884.jpg
images250.jpg
images23.jpg
happy-peaceful.jpg
images132.jpg
MV5BMTM3ODM0NTQ1MF5BMl5BanBnXkFtZTcwMzAxMTM5OA._V1_FMjpg_UX1000_.jpg
gdfVVm_MyCRtqpvdkt8vtSB1n_oz_CpwCq6vNMpj0S8.jpg
images245.jpg
images236.jpg
images79.jpg
images183.jpg
images197.jpg
happiness.jpg
images6.jpg
maxresdefault.jpg
shiny-happy-people.jpg
images7.jpg
images196.jpg
images182.jpg
20150413185238-secrets-happy-entrepreneurs-woman-gratitude-rainbow-.jpeg
images78.jpg
images50.jpg
happy-person.jpeg
images87.jpg
images91.jpg
images85.jpg
images235.jpg
image24.jpeg
group-portrait-happy-people-disabilities-49330313.jpg
images156.jpg
GettyImages-871518740.jpg
images195.jpg
nm-how-happiness-affects-health-tnail.jpg
images208.jpg
images47.jpg
images53.jpg
images220.jpg
images84.jpg
group-young-happy-people-with-their-hands-up_369728-62.jpg
images218.jpg
images57.jpg
images43.jpg
1HEoLBLidT2u4mhJ0oiDgig.png
images191.jpg
images146.jpg
where-to-watch-shiny-happy-people.jpg
happy-woman-in-nature-at-sunset.jpg
image25.jpeg
9b65a25adca61c48bcb01370116723e3--happy-people-brings.jpg
_happy_jumping_on_beach-40815.jpg
i00YzYyLTkxY2ItY2I3OWE3NDBmNDVmXkEyXkFqcGdeQXVyMjkwOTAyMDU._V1_FMjpg_UX1000_.jpg
VJdvLa-download-happy-blackman-png.png
Duggar-Family-Secrets-Are-Exposed-in-New-Docuseries-Featuring-Jill-and-Amy-featured.png
613k1XcpYCL.jpg
images42.jpg
images81.jpg
images95.jpg
56f455011e0000b300705475.jpeg
images83.jpg
hand-drawn-happy-friends-jumping_23-2149095224.jpg
images179.jpg
images150.jpg
A_Sep20_14_1189155141.jpg
ipsos-global-advisor-happiness-2022-opti.jpg
images193.jpg
images55.jpg
images232.jpg
happy-indians_5f66fd46d9f5b.jpg
images70.jpg
Happy-people-800x533.jpg
Screen-Shot-2012-10-23-at-12.57.22-PM.png
images161.jpg
images149.jpg
images148.jpg
images160.jpg
Screaming-Happy-Woman-THe-Trent.jpg
images71.jpg
343515-worldhappinessreport1440.jpg
happiness_thumbnail.jpg
images200.jpg
images214.jpg
images189.jpg
images176.jpg
happy-people.jpg
image30.jpeg
images66.jpg
Successful-year.jpg
images211.jpg
7VR73K6EP5ETVEOUFANWBUYJEQ.jpg
physed-happiness-superJumbo.jpg
images9.jpg
988689_Wallpaper2.jpg
happy-people2.jpg
35438_hd.jpg
images199.jpg
Happy-People-PNG.png
happy-people-vector-839522.jpg
images63.jpg
images210.jpg
images77.jpg
images204.jpg
images238.jpg
Dollarphotoclub_76084977-1.jpg
images49.jpg
images206.jpg
jumping-and-dancing-happy-people-positive-emotions-set-illustration-free-vector.jpg
habits-of-happy-people.jpg
1_617fd1e2590c2.jpg
dv2051009.jpg
happy-woman.jpg
377dac1b50ef865c920abb84d9d3857d173750b14306061e9aa5b4a1ec0dcdfa-rimg-w1196-h796-gmir.jpg
smile.woman_.jpg
images159.jpg
images74.jpg
images13.jpg
Happy-Guy.jpg
getty_152414899_97046097045006_68075.jpg
images102.jpg
images117.jpg
106827976-1611251261868-twenty20_33fd1f3f-9221-4c64-bcb1-bfeec3022d9b.jpg
images249.jpg
images12.jpg
image16.jpeg
images10.jpg
what-makes-people-happy1.jpg
getty_505175324_2000131020009280246_158016.jpg
group-of-happy-people-2.jpg
happy-people_1463241208.jpg
images128.jpg
images114.jpg
getty_478389113_970647970450091_99776.jpg
images11.jpg
images29.jpg
happy-people-in-the-poppy-field-1280x800-wide-wallpapers-net.jpg
images15.jpg
riskshappypeopletakeh_1384254283.jpg
835405.jpg
images110.jpg
hdptcar-fi-2.jpg
images105.jpg
images139.jpg
happy-woman-headphones-pink-african-american-1296x728-header.jpg
web3-happy-people-outside-smile-sun-nature-eduardo-dutra-620857-unsplash.jpg
hand-drawn-happy-people-jumping_23-2149092878.jpg
images14.jpg
goup-happy-people-35582464.jpg
compassion-900x387.jpg
images107.jpg
happypeople-1024x679.jpg
images106.jpg
images17.jpg
png-clipart-happiness-graphy-smile-happy-people-love-photography.png
42-15542443.jpg
sad-person-concept-vector-26538685.jpg
png-transparent-woman-sad-folklore-ghost-horror-spirit-vendetta-vengeance-girl-person-thumbnail.png
sad-people-icon-2CCHXB2.jpg
2652760.jpg
dreamstime_s_101440985.jpg
aid12707023-v4-1200px-Make-a-Sad-Person-Happy-Step-10.jpg
man-portrait-contemplative-sad-looking-at-camera-732x549-thumbnail.jpg
iStock_000001932580XSmall.jpg
pexels-photo-4584665.jpeg
n-rendering-frustrated-upset-man-sitting-white-people-man-character-53250684.jpg
image-asset.jpeg
sadness-person-depression-clip-art-bored-cliparts.jpg
sad-eating_620x350_71525950886.jpg
sadness-inside-out-today-main-tease-191018.jpg
maxresdefault2.jpg
images20.jpg
sad-adult-man-checking-bad-news-smart-phone-side-view-portrait-park-161654848.jpg
7RNXwSxCAKL8vGtXG2ZkyD-1200-80.jpg
getty_91745128_333755.jpg
depressed-woman-sitting-chair-dark-room-home_53476-2193.jpg
SAD.jpg
person-super-depressed.jpg
sad-glance-mm-nisan-kandilcioglu.jpg
73705bd7debb66c2afc780a22c223804.jpg
Sad-man-being-consoled-by-friends-in-group-therapy.jpg
214-2142366_transparent-depression-png-depressed-sad-person-png-png.png
maxresdefault.jpg
5acf9ed1146e711e008b46d7.jpg
Science_robotgait_124649246.jpg
Sadder-not-wiser_AdobeStock_219682170.jpg
283-2838105_clipart-resting-man-sad-person-silhouette-png.png
stock-photo-depressed-man-studio-shot-404652526.jpg
Make-someone-sad-happy.jpg
314071_2200-732x549.jpg
dark-depression-mood-people-wallpaper-preview.jpg
63218722.jpg
Sad-People.jpg
8iAb9k4aT.jpg
280-2804580_sad-people-png-sad-person-png-transparent-png.png
crying-at-work.jpg
all-those-people-who-are-sad-17573-1.jpg
anxious-man-indoors-front-view_23-2149729600.jpg
lonely-depressed-person-sitting-near-brick-wall_181624-30778.jpg
-unhappy-miss-good-chance-dressed-casually-isolated-yellow-wall_273609-37534.jpg
107188144-1675355909384-gettyimages-1302154722-dsc_9175.jpeg
sadness.jpg
depression-1020x680.jpg
crying-on-steps-e1505252236719-300x200.jpg
sad-people-vector-26812552.jpg
sad2.jpg
Depression-Quotes-from-Books-1-1.jpg
How-To-Make-Someone-Happy-When-Theyre-Sad.jpg
sad-depressed-man-702x375.jpg
sad-hero.jpg
1694806.jpg
sad-woman.jpg
pngtree-portrait-of-sad-person-vector-picture-image_2293852.jpg
405-4050267_sad-people-png-sad-person-transparent-background-png.png
man-tears-tear-look.jpg
Sad-man-sitting-in-bedroom-header.jpg
man-with-head-down-300x300.jpg
186918-afqmdoqiwx-1676522411.jpg
sad-people-group-therapy-session_23-2148752071.jpg
Depression-Vs-Sadness-Are-You-Just-Sad-Or-Depressed-2020-960x640.jpg
image-20160914-4963-19knfh1.jpg
sad-wise-woman-at-window.jpg
screen-shot-2014-07-31-at-6-09-12-pm.png
images14.jpg
_2539df08-4f50-11e6-85e3-522dd231fa74.jpg
boy-with-head-down.jpg
Seasonal-affective-disorder.png
b2ap3_large_happy-sad-unsplash-850x575.jpg</code></pre>
</div>
</div>
<div class="cell" data-execution_count="12">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>img <span class="op">=</span> cv2.imread(os.path.join(data_dir, <span class="st">"happy"</span>, <span class="st">"_86a43964-aa8e-11e8-82d1-388e3d6e11aa.jpg"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="13">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>img.shape</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="13">
<pre><code>(540, 960, 3)</code></pre>
</div>
</div>
<div class="cell" data-execution_count="14">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>plt.imshow(cv2.cvtColor(img, cv2.COLOR_BGR2RGB))</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="Image_Classification_files/figure-html/cell-14-output-1.png" class="img-fluid"></p>
</div>
</div>
<div class="cell" data-execution_count="15">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> image_class <span class="kw">in</span> os.listdir(data_dir):</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> image <span class="kw">in</span> os.listdir(os.path.join(data_dir, image_class)):</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>        image_path <span class="op">=</span> os.path.join(data_dir, image_class, image)</span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>        <span class="cf">try</span>:</span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>            img <span class="op">=</span> cv2.imread(image_path)</span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>            tip <span class="op">=</span> imghdr.what(image_path)</span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> tip <span class="kw">not</span> <span class="kw">in</span> image_exts:</span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a>                <span class="bu">print</span>(<span class="st">"Image not in ext list </span><span class="sc">{}</span><span class="st">"</span> .<span class="bu">format</span>(image_path))</span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a>                os.remove(image_path)</span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a>        <span class="cf">except</span> <span class="pp">Exception</span> <span class="im">as</span> e:</span>
<span id="cb21-11"><a href="#cb21-11" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="st">"Issue with image at </span><span class="sc">{}</span><span class="st">"</span> .<span class="bu">format</span>(image_path))</span>
<span id="cb21-12"><a href="#cb21-12" aria-hidden="true" tabindex="-1"></a>            <span class="co"># os.remove(image_path)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>libpng warning: iCCP: known incorrect sRGB profile</code></pre>
</div>
</div>
</section>
</section>
<section id="load-the-dataset" class="level2">
<h2 class="anchored" data-anchor-id="load-the-dataset">Load the dataset</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>tf.data.Dataset.??</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="16">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> matplotlib <span class="im">import</span> pyplot <span class="im">as</span> plt</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="17">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>data <span class="op">=</span> tf.keras.utils.image_dataset_from_directory(<span class="st">'data'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Found 256 files belonging to 2 classes.</code></pre>
</div>
</div>
<div class="cell" data-execution_count="18">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>data_iterators <span class="op">=</span> data.as_numpy_iterator()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="dataset-exploration" class="level1">
<h1>Dataset Exploration</h1>
<p>In this section, we explore the loaded dataset and visualize some sample images.</p>
<div class="cell" data-execution_count="20">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="co"># get another batch from data_iterators</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>batch <span class="op">=</span> data_iterators.<span class="bu">next</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="21">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="bu">len</span>(batch)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="21">
<pre><code>2</code></pre>
</div>
</div>
<div class="cell" data-execution_count="22">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="co"># images represent as numpy arrays</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>batch[<span class="dv">0</span>].shape</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="22">
<pre><code>(32, 256, 256, 3)</code></pre>
</div>
</div>
<div class="cell" data-execution_count="23">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="co"># class 0 = happy</span></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a><span class="co"># class 1 = sad</span></span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>batch[<span class="dv">1</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="23">
<pre><code>array([0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 1, 0, 0, 0, 0, 0, 1, 1,
       0, 0, 0, 0, 0, 1, 1, 0, 0, 0], dtype=int32)</code></pre>
</div>
</div>
<div class="cell" data-execution_count="24">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots(ncols<span class="op">=</span><span class="dv">4</span>, figsize<span class="op">=</span>(<span class="dv">20</span>, <span class="dv">20</span>))</span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> idx, img <span class="kw">in</span> <span class="bu">enumerate</span>(batch[<span class="dv">0</span>][:<span class="dv">4</span>]):</span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>    ax[idx].imshow(img.astype(<span class="bu">int</span>))</span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a>    ax[idx].title.set_text(batch[<span class="dv">1</span>][idx])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="Image_Classification_files/figure-html/cell-24-output-1.png" class="img-fluid"></p>
</div>
</div>
<div class="cell" data-execution_count="25">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>scaled <span class="op">=</span> batch[<span class="dv">0</span>]<span class="op">/</span><span class="dv">255</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="26">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>scaled[<span class="dv">0</span>].<span class="bu">max</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="26">
<pre><code>1.0</code></pre>
</div>
</div>
<section id="data-preprocessing---scaling" class="level2">
<h2 class="anchored" data-anchor-id="data-preprocessing---scaling">Data Preprocessing - Scaling</h2>
<p>In this section, we scale the pixel values of the images to be between 0 and 1.</p>
<div class="cell" data-execution_count="27">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>data <span class="op">=</span> data.<span class="bu">map</span>(<span class="kw">lambda</span> x, y: (x<span class="op">/</span><span class="dv">255</span>, y))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="28">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>scaled_iterator <span class="op">=</span> data.as_numpy_iterator()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="29">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>batch <span class="op">=</span> scaled_iterator.<span class="bu">next</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>2023-07-27 03:58:21.672218: W tensorflow/core/lib/png/png_io.cc:88] PNG warning: iCCP: known incorrect sRGB profile</code></pre>
</div>
</div>
<div class="cell" data-execution_count="30">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a>batch[<span class="dv">0</span>].<span class="bu">max</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="30">
<pre><code>1.0</code></pre>
</div>
</div>
<div class="cell" data-execution_count="31">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots(ncols<span class="op">=</span><span class="dv">4</span>, figsize<span class="op">=</span>(<span class="dv">20</span>, <span class="dv">20</span>))</span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> idx, img <span class="kw">in</span> <span class="bu">enumerate</span>(batch[<span class="dv">0</span>][:<span class="dv">4</span>]):</span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a>    ax[idx].imshow(img)</span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a>    ax[idx].title.set_text(batch[<span class="dv">1</span>][idx])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="Image_Classification_files/figure-html/cell-31-output-1.png" class="img-fluid"></p>
</div>
</div>
<div class="cell" data-execution_count="32">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="bu">len</span>(data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="32">
<pre><code>8</code></pre>
</div>
</div>
</section>
<section id="data-splitting" class="level2">
<h2 class="anchored" data-anchor-id="data-splitting">Data Splitting</h2>
<p>In this section, we split the dataset into training, validation, and test sets.</p>
<div class="cell" data-execution_count="33">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a>train_size <span class="op">=</span> <span class="bu">int</span>(<span class="bu">len</span>(data)<span class="op">*</span><span class="fl">.7</span>)</span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a>val_size <span class="op">=</span> <span class="bu">int</span>(<span class="bu">len</span>(data)<span class="op">*</span><span class="fl">.2</span>)<span class="op">+</span><span class="dv">1</span></span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a>test_size <span class="op">=</span> <span class="bu">int</span>(<span class="bu">len</span>(data)<span class="op">*</span><span class="fl">.1</span>)<span class="op">+</span><span class="dv">1</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="34">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a>train <span class="op">=</span> data.take(train_size)</span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a>val <span class="op">=</span> data.skip(train_size).take(val_size)</span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a>test <span class="op">=</span> data.skip(train_size<span class="op">+</span>val_size).take(test_size)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="35">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="bu">len</span>(test)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="35">
<pre><code>1</code></pre>
</div>
</div>
</section>
</section>
<section id="deep-model" class="level1">
<h1>DEEP MODEL</h1>
<section id="good-stuff" class="level2">
<h2 class="anchored" data-anchor-id="good-stuff">good stuff</h2>
</section>
<section id="model-architecture" class="level2">
<h2 class="anchored" data-anchor-id="model-architecture">Model Architecture</h2>
<p>In this section, we define the CNN model architecture using Keras. We use the Sequential model from Keras to define the CNN. The model consists of 3 convolutional layers with a ReLU activation function and max pooling layers in between. At the end of the model, we have a fully connected layer with a sigmoid activation function. We use the Adam optimizer and categorical cross entropy as the loss function.</p>
<div class="cell" data-execution_count="36">
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> tensorflow.keras.models <span class="im">import</span> Sequential</span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> tensorflow.keras.layers <span class="im">import</span> Dense, Conv2D, MaxPooling2D, Flatten</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="37">
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> Sequential()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output-display">
<div>
<div>
<pre class="mermaid mermaid-js">graph LR
  A[Input Layer] --&gt; B[Convolutional Layer 1]
  B --&gt; C[MaxPooling Layer 1]
  C --&gt; D[Convolutional Layer 2]
  D --&gt; E[MaxPooling Layer 2]
  E --&gt; F[Convolutional Layer 3]
  F --&gt; G[MaxPooling Layer 3]
  G --&gt; H[Flatten Layer]
  H --&gt; I[Dense Layer 1]
  I --&gt; J[Output Layer]

  style A fill:#f9f,stroke:#333,stroke-width:2px
  style B fill:#f9f,stroke:#333,stroke-width:2px
  style C fill:#f9f,stroke:#333,stroke-width:2px
  style D fill:#f9f,stroke:#333,stroke-width:2px
  style E fill:#f9f,stroke:#333,stroke-width:2px
  style F fill:#f9f,stroke:#333,stroke-width:2px
  style G fill:#f9f,stroke:#333,stroke-width:2px
  style H fill:#f9f,stroke:#333,stroke-width:2px
  style I fill:#f9f,stroke:#333,stroke-width:2px
  style J fill:#f9f,stroke:#333,stroke-width:2px

</pre>
</div>
</div>
</div>
</div>
<div class="cell" data-execution_count="38">
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a>model.add(Conv2D(<span class="dv">16</span>, (<span class="dv">3</span>, <span class="dv">3</span>), activation<span class="op">=</span><span class="st">'relu'</span>, input_shape<span class="op">=</span>(<span class="dv">256</span>, <span class="dv">256</span>, <span class="dv">3</span>)))</span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a>model.add(MaxPooling2D())</span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-4"><a href="#cb54-4" aria-hidden="true" tabindex="-1"></a>model.add(Conv2D(<span class="dv">32</span>, (<span class="dv">3</span>, <span class="dv">3</span>), activation<span class="op">=</span><span class="st">'relu'</span>))</span>
<span id="cb54-5"><a href="#cb54-5" aria-hidden="true" tabindex="-1"></a>model.add(MaxPooling2D())</span>
<span id="cb54-6"><a href="#cb54-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-7"><a href="#cb54-7" aria-hidden="true" tabindex="-1"></a>model.add(Conv2D(<span class="dv">64</span>, (<span class="dv">3</span>, <span class="dv">3</span>), activation<span class="op">=</span><span class="st">'relu'</span>))</span>
<span id="cb54-8"><a href="#cb54-8" aria-hidden="true" tabindex="-1"></a>model.add(MaxPooling2D())</span>
<span id="cb54-9"><a href="#cb54-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-10"><a href="#cb54-10" aria-hidden="true" tabindex="-1"></a>model.add(Flatten())</span>
<span id="cb54-11"><a href="#cb54-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-12"><a href="#cb54-12" aria-hidden="true" tabindex="-1"></a>model.add(Dense(<span class="dv">256</span>, activation<span class="op">=</span><span class="st">'relu'</span>))</span>
<span id="cb54-13"><a href="#cb54-13" aria-hidden="true" tabindex="-1"></a>model.add(Dense(<span class="dv">1</span>, activation<span class="op">=</span><span class="st">'sigmoid'</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="39">
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a>model.<span class="bu">compile</span>(optimizer<span class="op">=</span><span class="st">'adam'</span>, loss<span class="op">=</span><span class="st">'binary_crossentropy'</span>, metrics<span class="op">=</span>[<span class="st">'accuracy'</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="40">
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a>model.summary()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Model: "sequential"
_________________________________________________________________
 Layer (type)                Output Shape              Param #   
=================================================================
 conv2d (Conv2D)             (None, 254, 254, 16)      448       
                                                                 
 max_pooling2d (MaxPooling2  (None, 127, 127, 16)      0         
 D)                                                              
                                                                 
 conv2d_1 (Conv2D)           (None, 125, 125, 32)      4640      
                                                                 
 max_pooling2d_1 (MaxPoolin  (None, 62, 62, 32)        0         
 g2D)                                                            
                                                                 
 conv2d_2 (Conv2D)           (None, 60, 60, 64)        18496     
                                                                 
 max_pooling2d_2 (MaxPoolin  (None, 30, 30, 64)        0         
 g2D)                                                            
                                                                 
 flatten (Flatten)           (None, 57600)             0         
                                                                 
 dense (Dense)               (None, 256)               14745856  
                                                                 
 dense_1 (Dense)             (None, 1)                 257       
                                                                 
=================================================================
Total params: 14769697 (56.34 MB)
Trainable params: 14769697 (56.34 MB)
Non-trainable params: 0 (0.00 Byte)
_________________________________________________________________</code></pre>
</div>
</div>
</section>
</section>
<section id="model-training" class="level1">
<h1>Model Training</h1>
<section id="another-good-stuff" class="level2">
<h2 class="anchored" data-anchor-id="another-good-stuff">another good stuff</h2>
<p>In this section, we train the CNN model on the training and validation sets.</p>
<div class="cell" data-execution_count="41">
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a>log_dir <span class="op">=</span> <span class="st">"logs"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="42">
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a>tensorboard_callback <span class="op">=</span> tf.keras.callbacks.TensorBoard(log_dir<span class="op">=</span>log_dir)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="43">
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a>hist <span class="op">=</span> model.fit(train, epochs<span class="op">=</span><span class="dv">20</span>, validation_data<span class="op">=</span>val, callbacks<span class="op">=</span>[tensorboard_callback])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch 1/20
5/5 [==============================] - ETA: 0s - loss: 2.1236 - accuracy: 0.62505/5 [==============================] - 6s 852ms/step - loss: 2.1236 - accuracy: 0.6250 - val_loss: 1.0543 - val_accuracy: 0.3281
Epoch 2/20
5/5 [==============================] - ETA: 0s - loss: 0.7020 - accuracy: 0.57505/5 [==============================] - 5s 752ms/step - loss: 0.7020 - accuracy: 0.5750 - val_loss: 0.5787 - val_accuracy: 0.6719
Epoch 3/20
5/5 [==============================] - ETA: 0s - loss: 0.4572 - accuracy: 0.76885/5 [==============================] - 6s 886ms/step - loss: 0.4572 - accuracy: 0.7688 - val_loss: 0.4715 - val_accuracy: 0.7188
Epoch 4/20
5/5 [==============================] - ETA: 0s - loss: 0.4542 - accuracy: 0.76885/5 [==============================] - 6s 864ms/step - loss: 0.4542 - accuracy: 0.7688 - val_loss: 0.5098 - val_accuracy: 0.7188
Epoch 5/20
5/5 [==============================] - ETA: 0s - loss: 0.4182 - accuracy: 0.80625/5 [==============================] - 5s 749ms/step - loss: 0.4182 - accuracy: 0.8062 - val_loss: 0.3729 - val_accuracy: 0.9062
Epoch 6/20
5/5 [==============================] - ETA: 0s - loss: 0.3648 - accuracy: 0.83135/5 [==============================] - 5s 734ms/step - loss: 0.3648 - accuracy: 0.8313 - val_loss: 0.2589 - val_accuracy: 0.9375
Epoch 7/20
5/5 [==============================] - ETA: 0s - loss: 0.2975 - accuracy: 0.93125/5 [==============================] - 5s 735ms/step - loss: 0.2975 - accuracy: 0.9312 - val_loss: 0.3374 - val_accuracy: 0.7812
Epoch 8/20
5/5 [==============================] - ETA: 0s - loss: 0.2943 - accuracy: 0.86875/5 [==============================] - 5s 768ms/step - loss: 0.2943 - accuracy: 0.8687 - val_loss: 0.2920 - val_accuracy: 0.9062
Epoch 9/20
5/5 [==============================] - ETA: 0s - loss: 0.1788 - accuracy: 0.97505/5 [==============================] - 8s 1s/step - loss: 0.1788 - accuracy: 0.9750 - val_loss: 0.2523 - val_accuracy: 0.9062
Epoch 10/20
5/5 [==============================] - ETA: 0s - loss: 0.2026 - accuracy: 0.93755/5 [==============================] - 7s 1s/step - loss: 0.2026 - accuracy: 0.9375 - val_loss: 0.1680 - val_accuracy: 0.9375
Epoch 11/20
5/5 [==============================] - ETA: 0s - loss: 0.1517 - accuracy: 0.95635/5 [==============================] - 6s 898ms/step - loss: 0.1517 - accuracy: 0.9563 - val_loss: 0.1164 - val_accuracy: 0.9688
Epoch 12/20
5/5 [==============================] - ETA: 0s - loss: 0.1141 - accuracy: 0.98755/5 [==============================] - 6s 883ms/step - loss: 0.1141 - accuracy: 0.9875 - val_loss: 0.1531 - val_accuracy: 0.9531
Epoch 13/20
5/5 [==============================] - ETA: 0s - loss: 0.1109 - accuracy: 0.96885/5 [==============================] - 5s 796ms/step - loss: 0.1109 - accuracy: 0.9688 - val_loss: 0.0471 - val_accuracy: 1.0000
Epoch 14/20
5/5 [==============================] - ETA: 0s - loss: 0.0717 - accuracy: 0.98125/5 [==============================] - 5s 796ms/step - loss: 0.0717 - accuracy: 0.9812 - val_loss: 0.0218 - val_accuracy: 1.0000
Epoch 15/20
5/5 [==============================] - ETA: 0s - loss: 0.0526 - accuracy: 0.98755/5 [==============================] - 5s 695ms/step - loss: 0.0526 - accuracy: 0.9875 - val_loss: 0.0296 - val_accuracy: 0.9844
Epoch 16/20
5/5 [==============================] - ETA: 0s - loss: 0.0416 - accuracy: 0.99375/5 [==============================] - 5s 768ms/step - loss: 0.0416 - accuracy: 0.9937 - val_loss: 0.0382 - val_accuracy: 1.0000
Epoch 17/20
5/5 [==============================] - ETA: 0s - loss: 0.0256 - accuracy: 0.99375/5 [==============================] - 5s 900ms/step - loss: 0.0256 - accuracy: 0.9937 - val_loss: 0.0402 - val_accuracy: 0.9844
Epoch 18/20
5/5 [==============================] - ETA: 0s - loss: 0.0400 - accuracy: 0.99375/5 [==============================] - 7s 1s/step - loss: 0.0400 - accuracy: 0.9937 - val_loss: 0.0165 - val_accuracy: 1.0000
Epoch 19/20
5/5 [==============================] - ETA: 0s - loss: 0.0165 - accuracy: 1.00005/5 [==============================] - 5s 788ms/step - loss: 0.0165 - accuracy: 1.0000 - val_loss: 0.0145 - val_accuracy: 1.0000
Epoch 20/20
5/5 [==============================] - ETA: 0s - loss: 0.0105 - accuracy: 1.00005/5 [==============================] - 6s 1s/step - loss: 0.0105 - accuracy: 1.0000 - val_loss: 0.0081 - val_accuracy: 1.0000</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>2023-07-27 04:03:14.023704: W tensorflow/core/lib/png/png_io.cc:88] PNG warning: iCCP: known incorrect sRGB profile
2023-07-27 04:03:18.255534: W tensorflow/core/lib/png/png_io.cc:88] PNG warning: iCCP: known incorrect sRGB profile
2023-07-27 04:03:19.815394: W tensorflow/core/lib/png/png_io.cc:88] PNG warning: iCCP: known incorrect sRGB profile
2023-07-27 04:03:23.174734: W tensorflow/core/lib/png/png_io.cc:88] PNG warning: iCCP: known incorrect sRGB profile
2023-07-27 04:03:24.809815: W tensorflow/core/lib/png/png_io.cc:88] PNG warning: iCCP: known incorrect sRGB profile
2023-07-27 04:03:28.622819: W tensorflow/core/lib/png/png_io.cc:88] PNG warning: iCCP: known incorrect sRGB profile
2023-07-27 04:03:30.526848: W tensorflow/core/lib/png/png_io.cc:88] PNG warning: iCCP: known incorrect sRGB profile
2023-07-27 04:03:34.421046: W tensorflow/core/lib/png/png_io.cc:88] PNG warning: iCCP: known incorrect sRGB profile
2023-07-27 04:03:36.104529: W tensorflow/core/lib/png/png_io.cc:88] PNG warning: iCCP: known incorrect sRGB profile
2023-07-27 04:03:39.478804: W tensorflow/core/lib/png/png_io.cc:88] PNG warning: iCCP: known incorrect sRGB profile
2023-07-27 04:03:41.039956: W tensorflow/core/lib/png/png_io.cc:88] PNG warning: iCCP: known incorrect sRGB profile
2023-07-27 04:03:44.435770: W tensorflow/core/lib/png/png_io.cc:88] PNG warning: iCCP: known incorrect sRGB profile
2023-07-27 04:03:45.963591: W tensorflow/core/lib/png/png_io.cc:88] PNG warning: iCCP: known incorrect sRGB profile
2023-07-27 04:03:49.178376: W tensorflow/core/lib/png/png_io.cc:88] PNG warning: iCCP: known incorrect sRGB profile
2023-07-27 04:03:50.743021: W tensorflow/core/lib/png/png_io.cc:88] PNG warning: iCCP: known incorrect sRGB profile
2023-07-27 04:03:54.037560: W tensorflow/core/lib/png/png_io.cc:88] PNG warning: iCCP: known incorrect sRGB profile
2023-07-27 04:03:55.951233: W tensorflow/core/lib/png/png_io.cc:88] PNG warning: iCCP: known incorrect sRGB profile
2023-07-27 04:04:01.456234: W tensorflow/core/lib/png/png_io.cc:88] PNG warning: iCCP: known incorrect sRGB profile
2023-07-27 04:04:03.457572: W tensorflow/core/lib/png/png_io.cc:88] PNG warning: iCCP: known incorrect sRGB profile
2023-07-27 04:04:08.061141: W tensorflow/core/lib/png/png_io.cc:88] PNG warning: iCCP: known incorrect sRGB profile
2023-07-27 04:04:10.113932: W tensorflow/core/lib/png/png_io.cc:88] PNG warning: iCCP: known incorrect sRGB profile
2023-07-27 04:04:13.776048: W tensorflow/core/lib/png/png_io.cc:88] PNG warning: iCCP: known incorrect sRGB profile
2023-07-27 04:04:15.621654: W tensorflow/core/lib/png/png_io.cc:88] PNG warning: iCCP: known incorrect sRGB profile
2023-07-27 04:04:19.308929: W tensorflow/core/lib/png/png_io.cc:88] PNG warning: iCCP: known incorrect sRGB profile
2023-07-27 04:04:21.379377: W tensorflow/core/lib/png/png_io.cc:88] PNG warning: iCCP: known incorrect sRGB profile
2023-07-27 04:04:25.076040: W tensorflow/core/lib/png/png_io.cc:88] PNG warning: iCCP: known incorrect sRGB profile
2023-07-27 04:04:26.674164: W tensorflow/core/lib/png/png_io.cc:88] PNG warning: iCCP: known incorrect sRGB profile
2023-07-27 04:04:30.163587: W tensorflow/core/lib/png/png_io.cc:88] PNG warning: iCCP: known incorrect sRGB profile
2023-07-27 04:04:31.851561: W tensorflow/core/lib/png/png_io.cc:88] PNG warning: iCCP: known incorrect sRGB profile
2023-07-27 04:04:34.950114: W tensorflow/core/lib/png/png_io.cc:88] PNG warning: iCCP: known incorrect sRGB profile
2023-07-27 04:04:36.486424: W tensorflow/core/lib/png/png_io.cc:88] PNG warning: iCCP: known incorrect sRGB profile
2023-07-27 04:04:39.724312: W tensorflow/core/lib/png/png_io.cc:88] PNG warning: iCCP: known incorrect sRGB profile
2023-07-27 04:04:41.355761: W tensorflow/core/lib/png/png_io.cc:88] PNG warning: iCCP: known incorrect sRGB profile
2023-07-27 04:04:45.180619: W tensorflow/core/lib/png/png_io.cc:88] PNG warning: iCCP: known incorrect sRGB profile
2023-07-27 04:04:46.793976: W tensorflow/core/lib/png/png_io.cc:88] PNG warning: iCCP: known incorrect sRGB profile
2023-07-27 04:04:52.472749: W tensorflow/core/lib/png/png_io.cc:88] PNG warning: iCCP: known incorrect sRGB profile
2023-07-27 04:04:54.119024: W tensorflow/core/lib/png/png_io.cc:88] PNG warning: iCCP: known incorrect sRGB profile
2023-07-27 04:04:57.169953: W tensorflow/core/lib/png/png_io.cc:88] PNG warning: iCCP: known incorrect sRGB profile
2023-07-27 04:04:59.122699: W tensorflow/core/lib/png/png_io.cc:88] PNG warning: iCCP: known incorrect sRGB profile
2023-07-27 04:05:03.629668: W tensorflow/core/lib/png/png_io.cc:88] PNG warning: iCCP: known incorrect sRGB profile</code></pre>
</div>
</div>
<div class="cell" data-execution_count="44">
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a>hist.history</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="44">
<pre><code>{'loss': [2.1235644817352295,
  0.7019603252410889,
  0.4572330415248871,
  0.4541848301887512,
  0.41823139786720276,
  0.3647550344467163,
  0.29748818278312683,
  0.2943264842033386,
  0.178763285279274,
  0.20261912047863007,
  0.15168893337249756,
  0.11407314240932465,
  0.11092028766870499,
  0.07170285284519196,
  0.05255885794758797,
  0.04164768010377884,
  0.02555043436586857,
  0.03998959809541702,
  0.01653195358812809,
  0.01046471856534481],
 'accuracy': [0.625,
  0.574999988079071,
  0.768750011920929,
  0.768750011920929,
  0.8062499761581421,
  0.831250011920929,
  0.9312499761581421,
  0.8687499761581421,
  0.9750000238418579,
  0.9375,
  0.956250011920929,
  0.987500011920929,
  0.96875,
  0.981249988079071,
  0.987500011920929,
  0.9937499761581421,
  0.9937499761581421,
  0.9937499761581421,
  1.0,
  1.0],
 'val_loss': [1.0542879104614258,
  0.5787237286567688,
  0.4715065360069275,
  0.5098134875297546,
  0.3729403614997864,
  0.2589319348335266,
  0.33735647797584534,
  0.2919774055480957,
  0.25226324796676636,
  0.16799168288707733,
  0.11641531437635422,
  0.1531393826007843,
  0.04710891842842102,
  0.0218342412263155,
  0.029588568955659866,
  0.03818798065185547,
  0.04015404358506203,
  0.016501516103744507,
  0.014529326930642128,
  0.008069140836596489],
 'val_accuracy': [0.328125,
  0.671875,
  0.71875,
  0.71875,
  0.90625,
  0.9375,
  0.78125,
  0.90625,
  0.90625,
  0.9375,
  0.96875,
  0.953125,
  1.0,
  1.0,
  0.984375,
  1.0,
  0.984375,
  1.0,
  1.0,
  1.0]}</code></pre>
</div>
</div>
<div class="cell" data-execution_count="45">
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a>fig <span class="op">=</span> plt.figure()</span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a>plt.plot(hist.history[<span class="st">"loss"</span>], color<span class="op">=</span><span class="st">"teal"</span>, label<span class="op">=</span><span class="st">"loss"</span>)</span>
<span id="cb65-3"><a href="#cb65-3" aria-hidden="true" tabindex="-1"></a>plt.plot(hist.history[<span class="st">"val_loss"</span>], color<span class="op">=</span><span class="st">"orange"</span>, label<span class="op">=</span><span class="st">"val_loss"</span>)</span>
<span id="cb65-4"><a href="#cb65-4" aria-hidden="true" tabindex="-1"></a>fig.suptitle(<span class="st">"Loss"</span>, fontsize<span class="op">=</span><span class="dv">20</span>)</span>
<span id="cb65-5"><a href="#cb65-5" aria-hidden="true" tabindex="-1"></a>plt.legend(loc<span class="op">=</span><span class="st">"upper left"</span>)</span>
<span id="cb65-6"><a href="#cb65-6" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="Image_Classification_files/figure-html/cell-45-output-1.png" class="img-fluid"></p>
</div>
</div>
<div class="cell" data-execution_count="46">
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a>fig <span class="op">=</span> plt.figure()</span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a>plt.plot(hist.history[<span class="st">"accuracy"</span>], color<span class="op">=</span><span class="st">"teal"</span>, label<span class="op">=</span><span class="st">"accuracy"</span>)</span>
<span id="cb66-3"><a href="#cb66-3" aria-hidden="true" tabindex="-1"></a>plt.plot(hist.history[<span class="st">"val_accuracy"</span>], color<span class="op">=</span><span class="st">"orange"</span>, label<span class="op">=</span><span class="st">"val_accuracy"</span>)</span>
<span id="cb66-4"><a href="#cb66-4" aria-hidden="true" tabindex="-1"></a>fig.suptitle(<span class="st">"Accuracy"</span>, fontsize<span class="op">=</span><span class="dv">20</span>)</span>
<span id="cb66-5"><a href="#cb66-5" aria-hidden="true" tabindex="-1"></a>plt.legend(loc<span class="op">=</span><span class="st">"upper left"</span>)</span>
<span id="cb66-6"><a href="#cb66-6" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="Image_Classification_files/figure-html/cell-46-output-1.png" class="img-fluid"></p>
</div>
</div>
</section>
</section>
<section id="model-evaluation" class="level1">
<h1>Model Evaluation</h1>
<p>In this section, we evaluate the trained model on the test set.</p>
<div class="cell" data-execution_count="47">
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> tensorflow.keras.metrics <span class="im">import</span> Precision, Recall, BinaryAccuracy</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="48">
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a>pre <span class="op">=</span> Precision()</span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a>re <span class="op">=</span> Recall()</span>
<span id="cb68-3"><a href="#cb68-3" aria-hidden="true" tabindex="-1"></a>acc <span class="op">=</span> BinaryAccuracy()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="49">
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> batch <span class="kw">in</span> test.as_numpy_iterator():</span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a>    X, y <span class="op">=</span> batch</span>
<span id="cb69-3"><a href="#cb69-3" aria-hidden="true" tabindex="-1"></a>    yhat <span class="op">=</span> model.predict(X)</span>
<span id="cb69-4"><a href="#cb69-4" aria-hidden="true" tabindex="-1"></a>    pre.update_state(y, yhat)</span>
<span id="cb69-5"><a href="#cb69-5" aria-hidden="true" tabindex="-1"></a>    re.update_state(y, yhat)</span>
<span id="cb69-6"><a href="#cb69-6" aria-hidden="true" tabindex="-1"></a>    acc.update_state(y, yhat)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>2023-07-27 04:11:53.386443: W tensorflow/core/lib/png/png_io.cc:88] PNG warning: iCCP: known incorrect sRGB profile</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>1/1 [==============================] - 0s 329ms/step</code></pre>
</div>
</div>
<div class="cell" data-execution_count="50">
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Precision: </span><span class="sc">{}</span><span class="st">"</span> .<span class="bu">format</span>(pre.result().numpy()))</span>
<span id="cb72-2"><a href="#cb72-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Recall: </span><span class="sc">{}</span><span class="st">"</span> .<span class="bu">format</span>(re.result().numpy()))</span>
<span id="cb72-3"><a href="#cb72-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Accuracy: </span><span class="sc">{}</span><span class="st">"</span> .<span class="bu">format</span>(acc.result().numpy()))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Precision: 1.0
Recall: 1.0
Accuracy: 1.0</code></pre>
</div>
</div>
<section id="model-testing" class="level2">
<h2 class="anchored" data-anchor-id="model-testing">Model Testing</h2>
<p>In this section, we test the trained model on a new image.</p>
<div class="cell" data-execution_count="51">
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> cv2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="52">
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a>img <span class="op">=</span> cv2.imread(<span class="st">"sad_test.jpeg"</span>)</span>
<span id="cb75-2"><a href="#cb75-2" aria-hidden="true" tabindex="-1"></a>plt.imshow(cv2.cvtColor(img, cv2.COLOR_BGR2RGB))</span>
<span id="cb75-3"><a href="#cb75-3" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="Image_Classification_files/figure-html/cell-52-output-1.png" class="img-fluid"></p>
</div>
</div>
<div class="cell" data-execution_count="53">
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a>resize <span class="op">=</span> tf.image.resize(img, (<span class="dv">256</span>, <span class="dv">256</span>))</span>
<span id="cb76-2"><a href="#cb76-2" aria-hidden="true" tabindex="-1"></a>plt.imshow(resize.numpy().astype(<span class="bu">int</span>))</span>
<span id="cb76-3"><a href="#cb76-3" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="Image_Classification_files/figure-html/cell-53-output-1.png" class="img-fluid"></p>
</div>
</div>
<div class="cell" data-execution_count="54">
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a>np.expand_dims(resize, <span class="dv">0</span>).shape</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="54">
<pre><code>(1, 256, 256, 3)</code></pre>
</div>
</div>
<div class="cell" data-execution_count="55">
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a>yhat <span class="op">=</span> model.predict(np.expand_dims(resize<span class="op">/</span><span class="dv">255</span>, <span class="dv">0</span>))</span>
<span id="cb79-2"><a href="#cb79-2" aria-hidden="true" tabindex="-1"></a>yhat</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>1/1 [==============================] - 0s 68ms/step</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="55">
<pre><code>array([[0.96018517]], dtype=float32)</code></pre>
</div>
</div>
<div class="cell" data-execution_count="56">
<div class="sourceCode cell-code" id="cb82"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> yhat <span class="op">&lt;</span> <span class="fl">.5</span>:</span>
<span id="cb82-2"><a href="#cb82-2" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">"Happy"</span>)</span>
<span id="cb82-3"><a href="#cb82-3" aria-hidden="true" tabindex="-1"></a><span class="cf">else</span>:</span>
<span id="cb82-4"><a href="#cb82-4" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">"Sad"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Sad</code></pre>
</div>
</div>
</section>
<section id="model-saving-and-loading" class="level2">
<h2 class="anchored" data-anchor-id="model-saving-and-loading">Model Saving and Loading</h2>
<p>In this section, we save the trained model to disk and load it back for future use.</p>
<div class="cell" data-execution_count="57">
<div class="sourceCode cell-code" id="cb84"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> tensorflow.keras.models <span class="im">import</span> load_model</span>
<span id="cb84-2"><a href="#cb84-2" aria-hidden="true" tabindex="-1"></a>model.save(os.path.join(<span class="st">"models"</span>,<span class="st">"happysadmodel.h5"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/keras/src/engine/training.py:3000: UserWarning: You are saving your model as an HDF5 file via `model.save()`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')`.
  saving_api.save_model(</code></pre>
</div>
</div>
<div class="cell" data-execution_count="58">
<div class="sourceCode cell-code" id="cb86"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true" tabindex="-1"></a>new_model <span class="op">=</span> load_model(os.path.join(<span class="st">"models"</span>,<span class="st">"happysadmodel.h5"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="59">
<div class="sourceCode cell-code" id="cb87"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a>yhat_new <span class="op">=</span> new_model.predict(np.expand_dims(resize<span class="op">/</span><span class="dv">255</span>, <span class="dv">0</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>1/1 [==============================] - 0s 60ms/step</code></pre>
</div>
</div>
<div class="cell" data-execution_count="60">
<div class="sourceCode cell-code" id="cb89"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> yhat_new <span class="op">&lt;</span> <span class="fl">.5</span>:</span>
<span id="cb89-2"><a href="#cb89-2" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">"Happy"</span>)</span>
<span id="cb89-3"><a href="#cb89-3" aria-hidden="true" tabindex="-1"></a><span class="cf">else</span>:</span>
<span id="cb89-4"><a href="#cb89-4" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">"Sad"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Sad</code></pre>
</div>
</div>
<p>This notebook showcases the complete process of building, training, evaluating, and testing an image classification model for recognizing “happy” or “sad” emotions using Convolutional Neural Networks. The trained model can be saved and reloaded for future use, making it suitable for various real-world applications.</p>
</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>